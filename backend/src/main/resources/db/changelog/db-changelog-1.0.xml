<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">
    <changeSet id="create_user" author="anhquynhpham">
        <createTable tableName="users">
            <column name="id" type="int" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="email" type="varchar(100)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="password" type="varchar(100)">
                <constraints nullable="false"/>
            </column>
            <column name="is_admin" type="boolean" defaultValueNumeric="false">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <insert tableName="users">
            <column name="email">admin</column>
            <column name="password">240be518fabd2724ddb6f04eeb1da5967448d7e831c08c8fa822809f74c720a9
            </column> <!--admin123-->
        </insert>

        <insert tableName="users">
            <column name="email">alice</column>
            <column name="password">8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92
            </column> <!--123456-->
        </insert>

        <insert tableName="users">
            <column name="email">trace</column>
            <column name="password">8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92
            </column> <!--123456-->
        </insert>

        <update tableName="users">
            <column name="is_admin" value="true"/>
            <where>email='admin'</where>
        </update>
    </changeSet>

    <changeSet id="create_attraction" author="anhquynhpham">
        <createTable tableName="attractions">
            <column name="id" type="int" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="name" type="varchar(100)">
                <constraints nullable="false"/>
            </column>
            <column name="address" type="varchar(100)">
                <constraints nullable="false"/>
            </column>
            <column name="lat" type="float">
                <constraints nullable="false"/>
            </column>
            <column name="lng" type="float">
                <constraints nullable="false"/>
            </column>

            <column name="type" type="varchar(50)"/>

            <column name="description" type="varchar(1000)"/>
        </createTable>

        <sql dbms="postgresql"
             splitStatements="true"
             stripComments="true">
            insert into attractions(name, address, lat, lng, type, description) values ('29/3 park',
            '33 Điện Biên Phủ, Thạch Gián, Da Nang', 16.065548, 108.204486, 'Park',
            'Spacious city memorial park featuring hiking trails, paths, landscaped valleys and a lake.');

            insert into attractions(name, address, lat, lng, type, description) values ('Ban Co Peak',
            'Thọ Quang, Sơn Trà, Đà Nẵng', 16.118949, 108.271949, 'Tourist Attraction', '');

            insert into attractions(name, address, lat, lng, type, description) values ('Asia Park',
            '1 Phan Đăng Lưu, Hoà Cường Bắc, Hải Châu, Đà Nẵng', 16.039258, 108.228534, 'Park',
            'Amusement park with a massive Ferris wheel and other rides plus themed areas based on Asian countries.');

            insert into attractions(name, address, lat, lng, type, description) values ('Dragon Bridge',
            'Nguyễn Văn Linh, An Hải Trung, Đà Nẵng', 16.061210, 108.226976, 'Bridge',
            'Dragon-shaped bridge spanning the Han River, featuring colorful night illumination and fire shows.');

            insert into attractions(name, address, lat, lng, type, description) values ('Non Nuoc Pagoda',
            '98 Huyền Trân Công Chúa, Hòa Hải, Ngũ Hành Sơn, Đà Nẵng', 16.004199, 108.264244, 'Buddhist Temple', '');

            insert into attractions(name, address, lat, lng, type, description) values ('The Marble Mountains',
            '52 Huyền Trân Công Chúa, Hoà Hải, Ngũ Hành Sơn, Đà Nẵng', 16.003922, 108.262854, 'Tourist Attraction',
            'Network of 5 marble mountains with multiple caves, elaborate temples and viewing outlooks.');

            insert into attractions(name, address, lat, lng, type, description) values ('Hoa Trung Lake',
            'Hòa Vang, Da Nang', 16.079906, 108.055420, 'Lake', '');

            insert into attractions(name, address, lat, lng, type, description) values ('Son Tra Banyan Tree',
            'Thọ Quang, Sơn Trà, Đà Nẵng', 16.122540, 108.331703, 'Heritage Preservation',
            '800 year old banyan tree');

            insert into attractions(name, address, lat, lng, type, description) values ('Linh Ung Pagoda',
            'Hoàng Sa, Thọ Quang, Sơn Trà, Đà Nẵng', 16.100288, 108.277856, 'Buddhist Temple',
            'Buddhist temple, pagoda and large statue located on an elevated slope with sea and skyline views.');

            insert into attractions(name, address, lat, lng, type, description) values ('Sun World Ba Na Hills',
            'Hòa Vang, Đà Nẵng', 15.997735, 107.988077, 'Tourist Attraction', '');

            insert into attractions(name, address, lat, lng, type, description) values ('Than Tai Hot Springs Park',
            'QL14G, Hoà Phú, Hòa Vang, Đà Nẵng', 15.967851, 108.019805, 'Tourist Attraction', '');
        </sql>
    </changeSet>

    <changeSet id="create_plan" author="anhquynhpham">
        <createTable tableName="plans">
            <column name="id" type="int" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="name" type="varchar(100)">
                <constraints nullable="false"/>
            </column>
            <column name="start_day" type="varchar(10)"/>
            <column name="end_day" type="varchar(10)"/>
            <column name="user_id" type="int" defaultValueNumeric="1">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <addForeignKeyConstraint baseColumnNames="user_id"
                                 baseTableName="plans"
                                 constraintName="plan_fk"
                                 onDelete="CASCADE"
                                 onUpdate="CASCADE"
                                 referencedColumnNames="id"
                                 referencedTableName="users"/>

        <sql dbms="postgresql"
             splitStatements="true"
             stripComments="true">
            insert into plans(name, start_day, end_day, user_id) values ('Summer trip', '2018-04-01', '2018-04-02', 2);
            insert into plans(name, start_day, end_day, user_id) values ('30/4 Holiday', '2018-04-30', '2018-04-30', 3);
        </sql>
    </changeSet>

    <changeSet id="create_event" author="anhquynhpham">
        <createTable tableName="events">
            <column name="id" type="int" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="start_time" type="varchar(50)"/>
            <column name="end_time" type="varchar(50)"/>
            <column name="attraction_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="plan_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <addForeignKeyConstraint baseColumnNames="plan_id"
                                 baseTableName="events"
                                 constraintName="plan_fkey"
                                 onDelete="CASCADE"
                                 onUpdate="CASCADE"
                                 referencedColumnNames="id"
                                 referencedTableName="plans"/>

        <addForeignKeyConstraint baseColumnNames="attraction_id"
                                 baseTableName="events"
                                 constraintName="attraction_fkey"
                                 onDelete="CASCADE"
                                 onUpdate="CASCADE"
                                 referencedColumnNames="id"
                                 referencedTableName="attractions"/>

        <sql>
            insert into events(start_time, end_time, attraction_id, plan_id) values ('2018-04-01 7:00',
            '2018-04-01 9:30', 2, 1);
            insert into events(start_time, end_time, attraction_id, plan_id) values ('2018-04-01 9:30',
            '2018-04-01 10:30', 8, 1);
            insert into events(start_time, end_time, attraction_id, plan_id) values ('2018-04-01 10:30',
            '2018-04-01 14:00', 9, 1);
            insert into events(start_time, end_time, attraction_id, plan_id) values ('2018-04-02 9:00',
            '2018-04-02 16:00', 10, 1);
            insert into events(start_time, end_time, attraction_id, plan_id) values ('2018-04-30 8:00',
            '2018-04-02 9:30', 6, 2);
            insert into events(start_time, end_time, attraction_id, plan_id) values ('2018-04-30 9:30',
            '2018-04-02 12:00', 5, 2);
            insert into events(start_time, end_time, attraction_id, plan_id) values ('2018-04-30 16:00',
            '2018-04-02 21:30', 3, 2);
        </sql>

    </changeSet>

    <changeSet id="tag-1.0" author="anhquynhpham">
        <tagDatabase tag="1.0"/>
    </changeSet>

</databaseChangeLog>