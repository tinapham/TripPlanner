<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">

    <changeSet id="create_attraction" author="anhquynhpham" >
        <createTable tableName="attractions" >
            <column name="id" type="int" autoIncrement="true" >
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="name" type="varchar(100)" >
                <constraints nullable="false" />
            </column>
            <column name="address" type="varchar(100)" >
                <constraints nullable="false" />
            </column>
            <column name="lat" type="float" >
                <constraints nullable="false" />
            </column>
            <column name="lng" type="float" >
                <constraints nullable="false" />
            </column>

            <column name="type" type="varchar(50)" />

            <column name="description" type="varchar(1000)" />
        </createTable>

        <sql dbms="postgresql"
             splitStatements="true"
             stripComments="true">
            insert into attractions(name, address, lat, lng, type, description) values ('29/3 park', '33 Điện Biên Phủ, Thạch Gián, Da Nang, Vietnam', 16.065548, 108.204486, 'Park', 'Spacious city memorial park featuring hiking trails, paths, landscaped valleys and a lake.');
            insert into attractions(name, address, lat, lng, type, description) values ('Ban Co Peak', 'Thọ Quang, Sơn Trà, Da Nang, Vietnam', 16.118949, 108.271949, 'Tourist Attraction', '');
            insert into attractions(name, address, lat, lng, type, description) values ('Asia Park', '1 Phan Đăng Lưu, Hoà Cường Bắc, Hải Châu, Da Nang, Vietnam', 16.039258, 108.228534, 'Park', 'Amusement park with a massive Ferris wheel and other rides plus themed areas based on Asian countries.');
        </sql>
    </changeSet>

    <changeSet id="create_plan" author="anhquynhpham" >
        <createTable tableName="plans" >
            <column name="id" type="int" autoIncrement="true" >
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="name" type="varchar(100)" >
                <constraints nullable="false" />
            </column>
            <column name="start_day" type="varchar(10)" />
            <column name="end_day" type="varchar(10)" />
        </createTable>

        <sql dbms="postgresql"
             splitStatements="true"
             stripComments="true">
            insert into plans(name, start_day, end_day) values ('Summer trip', '2018-04-01', '2018-04-03');
        </sql>
    </changeSet>

    <changeSet id="create_event" author="anhquynhpham" >
        <createTable tableName="events" >
            <column name="id" type="int" autoIncrement="true" >
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="start_time" type="varchar(50)" />
            <column name="end_time" type="varchar(50)" />
            <column name="attraction_id" type="int" >
                <constraints nullable="false" />
            </column>
            <column name="plan_id" type="int" >
                <constraints nullable="false" />
            </column>
        </createTable>

        <addForeignKeyConstraint baseColumnNames="plan_id"
                                 baseTableName="events"
                                 constraintName="plan_fkey"
                                 onDelete="CASCADE"
                                 onUpdate="CASCADE"
                                 referencedColumnNames="id"
                                 referencedTableName="plans" />

        <addForeignKeyConstraint baseColumnNames="attraction_id"
                                 baseTableName="events"
                                 constraintName="attraction_fkey"
                                 onDelete="CASCADE"
                                 onUpdate="CASCADE"
                                 referencedColumnNames="id"
                                 referencedTableName="attractions" />

        <sql>
            insert into events(start_time, end_time, attraction_id, plan_id) values ('2018-01-04 13:30', '2018-01-04 16:30', 1, 1);
        </sql>

    </changeSet>

    <changeSet id="tag-1.0" author="anhquynhpham" >
        <tagDatabase tag="1.0" />
    </changeSet>

</databaseChangeLog>